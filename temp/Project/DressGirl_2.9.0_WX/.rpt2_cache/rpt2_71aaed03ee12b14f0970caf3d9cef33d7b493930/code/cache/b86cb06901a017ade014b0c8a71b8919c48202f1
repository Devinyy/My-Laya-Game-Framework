{
  "code": "import { LwgTools } from \"../../Lwg/Lwg\";\r\nimport { GameData } from \"../Control/GameData\";\r\nimport { GameRes } from \"../Control/GameRes\";\r\nimport { MainScene } from \"./MainScene\";\r\nexport class EndLessScene extends MainScene {\r\n    constructor() {\r\n        super(GameRes.Scene3D.EndLess.instance);\r\n        this.endlessLvData = [];\r\n        EndLessScene.ins = this;\r\n        console.log(EndLessScene.ins);\r\n    }\r\n    ready() {\r\n        Laya.timer.clearAll(this);\r\n        this.lenTotal = 0;\r\n        this.lenCur = 0;\r\n        this.road888.active = true;\r\n        this.creatStartUnit();\r\n        this.unitDynamicallyAdd();\r\n        this.unitHideAndShow();\r\n    }\r\n    creatStartUnit() {\r\n        LwgTools.Node.destroyAllChildren(this.unitParent);\r\n        const dataArr = GameData.Level.getEndlessLvData();\r\n        this.endlessLvFoodName = GameData.Level.getEndlessLvFood();\r\n        console.log(this.endlessLvFoodName);\r\n        this.endlessLvData = dataArr;\r\n        for (let index = 0; index < 2; index++) {\r\n            const unitObj = dataArr[index];\r\n            this.endUnit = GameRes.Prefab3D[unitObj.name].instance.clone();\r\n            this.unitParent.addChild(this.endUnit);\r\n            this.endUnit.transform.position = new Laya.Vector3(0, 0, this.lenTotal);\r\n            this.changeFood();\r\n            this.lenTotal += unitObj.length;\r\n            this.unitIndex = index;\r\n        }\r\n        LwgTools.Node.destroyAllChildren(this.marginParent);\r\n        for (let index = -2; index < 2; index++) {\r\n            const margin = GameRes.Prefab3D.margin.instance.clone();\r\n            this.marginParent.addChild(margin);\r\n            margin.transform.position = new Laya.Vector3(0, 0, index * 200);\r\n        }\r\n    }\r\n    unitDynamicallyAdd() {\r\n        Laya.timer.frameLoop(30, this, () => {\r\n            if (this.endUnit) {\r\n                if (this.endUnit.transform.position.z - this.camaraPoint.transform.position.z < 50) {\r\n                    const unitObj = this.endlessLvData[this.unitIndex];\r\n                    if (unitObj) {\r\n                        this.endUnit = GameRes.Prefab3D[unitObj.name].instance.clone();\r\n                        this.unitParent.addChild(this.endUnit);\r\n                        this.endUnit.transform.position = new Laya.Vector3(0, 0, this.lenTotal);\r\n                        this.changeFood();\r\n                        this.lenTotal += unitObj.length;\r\n                        this.unitIndex++;\r\n                        console.log(unitObj.name);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    changeFood() {\r\n        for (let index = 0; index < this.endUnit.numChildren; index++) {\r\n            const child = this.endUnit.getChildAt(index);\r\n            if (child['newFood']) {\r\n                continue;\r\n            }\r\n            let newFood;\r\n            if (child.name.substr(0, 5) === 'FoodB' || child.name.substr(0, 5) === 'FoodA') {\r\n                newFood = GameRes.Prefab3D[this.endlessLvFoodName].instance.clone();\r\n                this.endUnit.addChild(newFood);\r\n                newFood.transform.position = child.transform.position.clone();\r\n                newFood['newFood'] = true;\r\n                child.active = false;\r\n            }\r\n        }\r\n    }\r\n    unitHideAndShow() {\r\n        Laya.timer.frameLoop(1, this, () => {\r\n            for (let index = 0; index < this.unitParent.numChildren; index++) {\r\n                const unit = this.unitParent.getChildAt(index);\r\n                if (this.camaraPoint.transform.localPositionZ - unit.transform.position.z > 80) {\r\n                    unit.destroy(true);\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "E:/svn/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Lwg/Lwg.ts",
    "E:/svn/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameData.ts",
    "E:/svn/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameRes.ts",
    "E:/svn/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameType.ts",
    "E:/svn/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Game3D/MainScene.ts"
  ]
}
