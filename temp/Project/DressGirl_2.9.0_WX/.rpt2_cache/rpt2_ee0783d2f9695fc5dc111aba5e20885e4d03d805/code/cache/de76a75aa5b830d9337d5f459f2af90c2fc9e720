{
  "code": "import { ui } from \"../../../ui/layaMaxUI\";\r\nimport { LwgClick, LwgCurrency, LwgDialogue, LwgScene } from \"../../Lwg/Lwg\";\r\nimport { GameData } from \"../Control/GameData\";\r\nimport { GameEnum } from \"../Control/GameEnum\";\r\nimport GameSceneName from \"../Control/GameSceneName\";\r\nexport default class SkillUpgradeObj extends ui.Views.SkillUpgradeObjUI {\r\n    constructor() {\r\n        super();\r\n    }\r\n    onAwake() {\r\n        const arr = [];\r\n        for (let index = 0; index < GameData.Skill.getTypeNum; index++) {\r\n            const data = {\r\n                ID: null,\r\n                name: null,\r\n                level: null,\r\n                type: index,\r\n                consume: null,\r\n                addition: null,\r\n            };\r\n            arr.push(data);\r\n        }\r\n        this.list.array = arr;\r\n        this.list.renderHandler = new Laya.Handler(this, this.onlistRender);\r\n    }\r\n    onlistRender(view, index) {\r\n        const data = view.dataSource;\r\n        view.name = 'skill';\r\n        switch (data.type) {\r\n            case GameEnum.SkillType.Attack:\r\n                view.imgName.skin = 'Game/UI/img_text_skill_01.png';\r\n                view.imgSkillIcon.skin = 'Game/UI/img_icon_mainui_shengjiicon01.png';\r\n                break;\r\n            case GameEnum.SkillType.settlement:\r\n                view.imgName.skin = 'Game/UI/img_text_skill_02.png';\r\n                view.imgSkillIcon.skin = 'Game/UI/img_icon_mainui_shengjiicon02.png';\r\n                break;\r\n            case GameEnum.SkillType.HP:\r\n                view.imgName.skin = 'Game/UI/img_text_skill_03.png';\r\n                view.imgSkillIcon.skin = 'Game/UI/img_icon_mainui_shengjiicon03.png';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        const lv = GameData.Skill.getCurLevelByType(data.type);\r\n        view.lbLevel.text = '等级' + lv.toString();\r\n        data.level = lv;\r\n        const maxLv = GameData.Skill.getMaxLevelByType(data.type);\r\n        if (data.level >= maxLv) {\r\n            view.ImgMaxLv.visible = true;\r\n            view.imgResIcon.visible = false;\r\n            view.lbConsume.visible = false;\r\n            view.ImgResBoard.visible = false;\r\n        }\r\n        else {\r\n            view.ImgMaxLv.visible = false;\r\n            view.imgResIcon.visible = true;\r\n            view.lbConsume.visible = true;\r\n            view.ImgResBoard.visible = true;\r\n        }\r\n        const consume = GameData.Skill.getCurConsumeByType(data.type);\r\n        view.lbConsume.text = consume.toString();\r\n        data.consume = consume;\r\n        LwgClick.off(LwgClick.EmEffectType.largen, view.imgBoard, this, null, null, this.onBtnUpgrade);\r\n        LwgClick.on(LwgClick.EmEffectType.largen, view.imgBoard, this, null, null, this.onBtnUpgrade, null, [[], [], [data], []]);\r\n    }\r\n    onBtnUpgrade(data) {\r\n        const maxLv = GameData.Skill.getMaxLevelByType(data.type);\r\n        if (data.level >= maxLv) {\r\n            LwgDialogue.showTips('等级已满');\r\n        }\r\n        else {\r\n            if (LwgCurrency.Diamond.num >= data.consume) {\r\n                LwgDialogue.showTips('升级成功');\r\n                GameData.Sound.playSoundByID(13);\r\n                this.list.refresh();\r\n                data.level++;\r\n                GameData.Skill.addLevelByType(data.type);\r\n                LwgCurrency.Diamond.subNumDisPlayNode(data.consume);\r\n                data.consume = GameData.Skill.getCurConsumeByType(data.type);\r\n            }\r\n            else {\r\n                const data = {\r\n                    type: GameEnum.ResType.Diamond,\r\n                };\r\n                LwgScene.openOverlayScene(GameSceneName.ADGetReward, data);\r\n            }\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/ui/layaMaxUI.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Lwg/Lwg.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameData.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameEnum.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameSceneName.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameType.ts"
  ]
}
