{
  "code": "import { LwgClick, LwgControl, LwgScene } from \"../../Lwg/Lwg\";\r\nimport { GameEvent } from \"../Control/GameEvent\";\r\nimport GameSceneName from \"../Control/GameSceneName\";\r\nimport { GameData } from \"../Control/GameData\";\r\nimport { Control3D } from \"../Game3D/Control3D\";\r\nexport default class Levels extends LwgScene.SceneBase {\r\n    get curCcore() {\r\n        return this['_curCcore'] ? this['_curCcore'] : 0;\r\n    }\r\n    set curCcore(val) {\r\n        this['_curCcore'] = val;\r\n    }\r\n    get growthValue() {\r\n        return this['_growthValue'] ? this['_growthValue'] : 0;\r\n    }\r\n    set growthValue(val) {\r\n        this['_growthValue'] = val;\r\n        this.owner.lbGrowthValue.text = val.toString();\r\n    }\r\n    lwgOnAwake() {\r\n        this.curCcore = 0;\r\n    }\r\n    lwgOnStart() {\r\n        Control3D.start();\r\n        this.setLevelProgress();\r\n        this.updateKey();\r\n    }\r\n    setLevelProgress() {\r\n        this.owner.lbCurLevel.text = LwgControl.Game.levelReal.toString();\r\n    }\r\n    lwgEvent() {\r\n        this.evRegister(GameEvent.updateLevelDisplay, (pos) => {\r\n            this.owner.boxRoleLv.pos(pos.x, pos.y);\r\n        });\r\n        this.evRegister(GameEvent.readyVSBOSS, () => {\r\n            this.owner.boxLv.visible = false;\r\n            this.owner.boxRoleLv.visible = false;\r\n        });\r\n        this.evRegister(GameEvent.updateRoleHP, (hp) => {\r\n            if (!this.roleFirstHp) {\r\n                this.roleFirstHp = hp;\r\n            }\r\n            this.owner.lbRoleHP.visible = true;\r\n            this.owner.lbRoleHP.text = hp.toString();\r\n            this.owner.imgRoleHp.mask.width = hp / this.roleFirstHp * this.owner.imgRoleHp.width;\r\n            if (hp <= 0) {\r\n                hp = 0;\r\n                this.owner.imgRoleHp.mask.width = 0;\r\n                this.owner.lbRoleHP.text = '0';\r\n            }\r\n        });\r\n        this.evRegister(GameEvent.updateBossHP, (hp) => {\r\n            if (!this.bossFirstHp) {\r\n                this.bossFirstHp = hp;\r\n            }\r\n            this.owner.lbBossHP.visible = true;\r\n            this.owner.lbBossHP.text = hp.toString();\r\n            this.owner.imgBossHp.mask.width = hp / this.bossFirstHp * this.owner.imgBossHp.width;\r\n            if (hp <= 0) {\r\n                hp = 0;\r\n                this.owner.imgBossHp.mask.width = 0;\r\n                this.owner.lbBossHP.text = '0';\r\n            }\r\n        });\r\n        this.evRegister(GameEvent.attackByClickStart, () => {\r\n            this.owner.boxRefuel.visible = true;\r\n            this.owner.boxLv.visible = false;\r\n            this.owner.boxVS.visible = true;\r\n            this.owner.aniRefuel1.play(0, false);\r\n            Laya.timer.once(500, this, () => {\r\n                this.owner.aniRefuel2.play(0, true);\r\n            });\r\n        });\r\n        this.evRegister(GameEvent.attackByClickEnd, () => {\r\n            this.owner.boxRefuel.visible = false;\r\n        });\r\n        this.evRegister(GameEvent.updateGrowthValue, (growthValue, lv) => {\r\n            this.growthValue = growthValue;\r\n            let curValue = 0;\r\n            let baseValue = 50;\r\n            switch (lv) {\r\n                case 1:\r\n                    baseValue = 50;\r\n                    break;\r\n                case 2:\r\n                    baseValue = 100;\r\n                    break;\r\n                case 3:\r\n                    baseValue = 150;\r\n                    break;\r\n                case 4:\r\n                    baseValue = 200;\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            if (growthValue >= 200) {\r\n                growthValue = 200;\r\n            }\r\n            curValue = growthValue % baseValue;\r\n            this.owner.imgRoleLv.mask.width = Math.round(this.owner.imgRoleLv.width * (curValue / baseValue));\r\n            this.owner.lbRoleLv.text = 'Lv.' + lv;\r\n        });\r\n        this.evRegister(GameEvent.updateScore, (score0) => {\r\n            this.curCcore += score0;\r\n        });\r\n        this.evRegister(GameEvent.updateLvSchedule, (per) => {\r\n            this.owner.levelProgress.mask.width = per * 280;\r\n        });\r\n        this.evRegister(GameEvent.victory, () => {\r\n            const data = {\r\n                score: this.curCcore,\r\n            };\r\n            this.openScene(GameSceneName.Victory, data);\r\n        });\r\n        this.evRegister(GameEvent.defeated, () => {\r\n            const data = {\r\n                score: this.curCcore,\r\n            };\r\n            this.openScene(GameSceneName.Defeated, data);\r\n        });\r\n        this.evRegister(GameEvent.pickedKey, () => {\r\n            GameData.Lottery.KeyNum++;\r\n            this.updateKey();\r\n        });\r\n    }\r\n    lwgButton() {\r\n        this.btnOnFour(this.owner.btnRefuel, () => {\r\n            this.owner.btnRefuel.skin = 'Game/UI/img_btn_zadan_chick_press.png';\r\n        }, () => {\r\n        }, () => {\r\n            this.evNotify(GameEvent.attackByClick);\r\n            this.owner.btnRefuel.skin = 'Game/UI/img_btn_zadan_chick_normal.png';\r\n        }, () => {\r\n        }, LwgClick.EmEffectType.noEffect);\r\n    }\r\n    updateKey() {\r\n        for (let index = 1; index < 4; index++) {\r\n            if (index > GameData.Lottery.KeyNum) {\r\n                this.owner[`key${index}`].visible = false;\r\n            }\r\n            else {\r\n                this.owner[`key${index}`].visible = true;\r\n            }\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Lwg/Lwg.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameRes.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameEvent.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/ui/layaMaxUI.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameSceneName.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameType.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Control/GameData.ts",
    "E:/SVN/老王哥/恐龙跑酷/DinosaursGrow_Laya_2.9.0/DinosaursGrowUp_2.9.0/src/script/Game/Game3D/Control3D.ts"
  ]
}
