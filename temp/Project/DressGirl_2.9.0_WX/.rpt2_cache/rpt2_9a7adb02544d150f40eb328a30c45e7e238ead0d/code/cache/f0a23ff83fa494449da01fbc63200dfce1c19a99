{
  "code": "import { LwgClick, LwgCurrency, LwgDialogue, LwgPlatform, LwgScene } from \"../../Lwg/Lwg\";\r\nimport { GameData } from \"../Control/GameData\";\r\nimport { GameEff2D } from \"../Control/GameEff2D\";\r\nimport { GameEnum } from \"../Control/GameEnum\";\r\nimport GameSceneName from \"../Control/GameSceneName\";\r\nimport { Control3D } from \"../Game3D/Control3D\";\r\nimport { SkinScene } from \"../Game3D/SkinScene\";\r\nexport default class Skin extends LwgScene.SceneBase {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._tapIndex = 0;\r\n    }\r\n    get tapIndex() {\r\n        return this._tapIndex;\r\n    }\r\n    set tapIndex(index) {\r\n        if (index == 0) {\r\n            this.owner.list.array = GameData.Skin.getSkinArrByPart(GameEnum.Part.dress);\r\n        }\r\n        else if (index == 1) {\r\n            this.owner.list.array = GameData.Skin.getSkinArrByPart(GameEnum.Part.hair);\r\n        }\r\n        else if (index == 2) {\r\n            this.owner.list.array = GameData.Skin.getSkinArrByPart(GameEnum.Part.wing);\r\n        }\r\n        for (let index = 0; index < this.owner.list.array.length; index++) {\r\n            const element = this.owner.list.array[index];\r\n            if (element.ID === GameData.Skin.pitchDressID || element.ID === GameData.Skin.pitchHairID || element.ID === GameData.Skin.pitchWingID) {\r\n                this.dataPitch = element;\r\n                this.dataPitch.index = index;\r\n                break;\r\n            }\r\n        }\r\n        if (index === 2) {\r\n            SkinScene.ins.turnBack();\r\n        }\r\n        else {\r\n            SkinScene.ins.turnFront();\r\n        }\r\n        this.updateBtn();\r\n        this.owner.list.refresh();\r\n        this._tapIndex = index;\r\n    }\r\n    lwgOnAwake() {\r\n        this.owner.list.renderHandler = new Laya.Handler(this, this.onListRender);\r\n        this.owner.list.hScrollBarSkin = '';\r\n        this.tapIndex = 0;\r\n    }\r\n    lwgOpenAniAfter() {\r\n        Control3D.showSkinScene();\r\n    }\r\n    onListRender(view, index) {\r\n        const data = view.dataSource;\r\n        view.imgIcon.skin = `Game/UI/SkinIcon/${data.name}.png`;\r\n        if (index === this.dataPitch.index) {\r\n            view.imgAniBoard.visible = true;\r\n        }\r\n        else {\r\n            view.imgAniBoard.visible = false;\r\n        }\r\n        view.imgLock.visible = !data.complete;\r\n        view.imgDesIcon.visible = false;\r\n        view.lbDescribe.centerX = 0;\r\n        if (data.complete) {\r\n            if (data.ID === GameData.Skin.pitchDressID || data.ID === GameData.Skin.pitchHairID || data.ID === GameData.Skin.pitchWingID) {\r\n                view.lbDescribe.text = '装备中';\r\n            }\r\n            else {\r\n                view.lbDescribe.text = '已获得';\r\n            }\r\n        }\r\n        else {\r\n            switch (data.pathWay) {\r\n                case GameEnum.ItemPathWay.AD:\r\n                    view.imgDesIcon.visible = true;\r\n                    view.imgDesIcon.skin = 'Game/UI/img_icon_common_ad_02.png';\r\n                    if (!data.degreeNum) {\r\n                        data.degreeNum = 0;\r\n                    }\r\n                    view.lbDescribe.text = '(' + data.degreeNum + '/' + data.condition + ')';\r\n                    view.lbDescribe.centerX = 10;\r\n                    break;\r\n                case GameEnum.ItemPathWay.CheckIn:\r\n                    view.lbDescribe.text = '签到获得';\r\n                    break;\r\n                case GameEnum.ItemPathWay.Free:\r\n                    view.lbDescribe.text = '已获得';\r\n                    break;\r\n                case GameEnum.ItemPathWay.Diamond:\r\n                    view.imgDesIcon.visible = true;\r\n                    view.imgDesIcon.skin = 'Game/UI/img_icon_money_01.png';\r\n                    view.lbDescribe.text = data.condition;\r\n                    view.lbDescribe.centerX = 10;\r\n                    break;\r\n                case GameEnum.ItemPathWay.LotteryChest:\r\n                    view.lbDescribe.text = '开宝箱';\r\n                    break;\r\n                case GameEnum.ItemPathWay.LuckyWheel:\r\n                    view.lbDescribe.text = '幸运抽奖';\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        LwgClick.off(view);\r\n        LwgClick.on(undefined, view, this, null, null, (e, args) => {\r\n            this.onListRenderClick(args);\r\n        }, null, [{}, {}, { view: view, data: data, index: index }, {}]);\r\n    }\r\n    onListRenderClick(args) {\r\n        this.dataPitch = args.data;\r\n        this.dataPitch.index = args.index;\r\n        SkinScene.ins.change(args.data.ID);\r\n        this.owner.list.refresh();\r\n        this.updateBtn();\r\n        if (this.dataPitch.complete) {\r\n            if (this.dataPitch.part === GameEnum.Part.dress) {\r\n                GameData.Skin.pitchDressID = this.dataPitch.ID;\r\n            }\r\n            if (this.dataPitch.part === GameEnum.Part.hair) {\r\n                GameData.Skin.pitchHairID = this.dataPitch.ID;\r\n            }\r\n            if (this.dataPitch.part === GameEnum.Part.wing) {\r\n                GameData.Skin.pitchWingID = this.dataPitch.ID;\r\n            }\r\n        }\r\n    }\r\n    updateBtn() {\r\n        if (this.dataPitch.degreeNum === undefined) {\r\n            this.dataPitch.degreeNum = 0;\r\n        }\r\n        let name;\r\n        switch (this.dataPitch.pathWay) {\r\n            case GameEnum.ItemPathWay.AD:\r\n                name = 'boxAD';\r\n                this.owner.boxADNum.text = '(' + this.dataPitch.degreeNum + '/' + this.dataPitch.condition + ')';\r\n                break;\r\n            case GameEnum.ItemPathWay.CheckIn:\r\n                name = 'boxCheckIn';\r\n                break;\r\n            case GameEnum.ItemPathWay.Free:\r\n                name = 'boxFree';\r\n                break;\r\n            case GameEnum.ItemPathWay.Diamond:\r\n                name = 'boxGold';\r\n                this.owner.boxGoldNum.text = this.dataPitch.condition.toString();\r\n                break;\r\n            case GameEnum.ItemPathWay.LotteryChest:\r\n                name = 'boxLotteryChest';\r\n                break;\r\n            case GameEnum.ItemPathWay.LuckyWheel:\r\n                name = 'boxLuckyWheel';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        for (let index = 0; index < this.owner.btnGet.numChildren; index++) {\r\n            const element = this.owner.btnGet.getChildAt(index);\r\n            if (element.name == name) {\r\n                element.visible = true;\r\n            }\r\n            else {\r\n                element.visible = false;\r\n            }\r\n        }\r\n        if (this.dataPitch.complete) {\r\n            this.owner.btnGet.visible = false;\r\n        }\r\n        else {\r\n            this.owner.btnGet.visible = true;\r\n        }\r\n    }\r\n    compelet() {\r\n        this.dataPitch.complete = true;\r\n        GameData.Skin.setCompeletByData(this.dataPitch);\r\n        this.owner.list.refresh();\r\n        this.updateBtn();\r\n        const cell = this.owner.list.getCell(this.dataPitch.index);\r\n        const lpos = this.owner.list.localToGlobal(new Laya.Point(cell.x + cell.width / 2, cell.y + cell.height / 2));\r\n        GameEff2D.oneFireworks3(this.owner, lpos);\r\n        GameData.Sound.playSoundByID(7);\r\n    }\r\n    lwgButton() {\r\n        for (let i = 0; i < this.owner.boxTap.numChildren; i++) {\r\n            const element = this.owner.boxTap.getChildAt(i);\r\n            this.btnOnDown(element, () => {\r\n                for (let index = 0; index < this.owner.boxTap.numChildren; index++) {\r\n                    const elementbtn = this.owner.boxTap.getChildAt(index);\r\n                    if (elementbtn === element) {\r\n                        elementbtn.skin = 'Game/UI/img_btn_tab_1.png';\r\n                        this.tapIndex = index;\r\n                    }\r\n                    else {\r\n                        elementbtn.skin = 'Game/UI/img_btn_tab_2.png';\r\n                    }\r\n                }\r\n            }, LwgClick.EmEffectType.NoEffect);\r\n        }\r\n        this.btnOnUp(this.owner.btnReturn, () => {\r\n            this.openScene(GameSceneName.Start, null, true);\r\n        });\r\n        this.btnOnUp(this.owner.btnGet, () => {\r\n            if (this.dataPitch.complete) {\r\n                LwgDialogue.showTips('已经获得！');\r\n                return;\r\n            }\r\n            switch (this.dataPitch.pathWay) {\r\n                case GameEnum.ItemPathWay.AD:\r\n                    LwgPlatform.AD.showVideo(() => {\r\n                        this.dataPitch.degreeNum++;\r\n                        this.owner.boxADNum.text = '(' + this.dataPitch.degreeNum + '/' + this.dataPitch.condition + ')';\r\n                        if (this.dataPitch.degreeNum >= +this.dataPitch.condition) {\r\n                            this.compelet();\r\n                        }\r\n                    });\r\n                    break;\r\n                case GameEnum.ItemPathWay.CheckIn:\r\n                    LwgDialogue.showTips('签到页面获取！');\r\n                    break;\r\n                case GameEnum.ItemPathWay.Free:\r\n                    LwgDialogue.showTips('已经获得！');\r\n                    break;\r\n                case GameEnum.ItemPathWay.Diamond:\r\n                    if (LwgCurrency.Diamond.num >= +this.dataPitch.condition) {\r\n                        this.compelet();\r\n                        LwgDialogue.showTips('购买成功！');\r\n                    }\r\n                    else {\r\n                        const data = {\r\n                            type: GameEnum.ResType.Diamond,\r\n                        };\r\n                        LwgScene.openOverlayScene(GameSceneName.ADGetReward, data);\r\n                    }\r\n                    break;\r\n                case GameEnum.ItemPathWay.LotteryChest:\r\n                    LwgDialogue.showTips('宝箱页面获取！');\r\n                    break;\r\n                case GameEnum.ItemPathWay.LuckyWheel:\r\n                    LwgDialogue.showTips('抽奖页面获取！');\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/ui/layaMaxUI.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Lwg/Lwg.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Game/Control/GameData.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Game/Control/GameEff2D.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Game/Control/GameEnum.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Game/Control/GameSceneName.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Game/Control/GameType.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Game/Game3D/Control3D.ts",
    "E:/svn/泡泡/Bubble_Laya_2.9.0/Project/src/script/Game/Game3D/SkinScene.ts"
  ]
}
